{"id":109,"date":"2020-08-19T03:06:14","date_gmt":"2020-08-19T03:06:14","guid":{"rendered":"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/"},"modified":"2024-04-27T18:34:12","modified_gmt":"2024-04-27T21:34:12","slug":"capturas-em-massa","status":"publish","type":"post","link":"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/","title":{"rendered":"Capturas em massa"},"content":{"rendered":"<p>Vamos supor que, por algum motivo, voc\u00ea precisa tirar milhares de capturas de v\u00eddeos em tempos espec\u00edficos, como voc\u00ea faria isso? Pesquisar no StackOverflow e pegar a primeira resposta que sair parece tentador, mas podemos fazer melhor!<\/p>\n<p>A maioria das respostas ir\u00e1 sugerir para usar o ffmpeg. Na maioria dos casos ele \u00e9 realmente a melhor op\u00e7\u00e3o por ser simples de usar: &quot;ffmpeg -ss tempo -i fonte.mp4 -vframes 1 destino.png&quot;, repetir isso a quantidade de vezes que for necess\u00e1ria e o problema est\u00e1 resolvido. Por outro lado esse m\u00e9todo tem certos problemas:<\/p>\n<ul>\n<li>Voc\u00ea precisa de iniciar uma inst\u00e2ncia do ffmpeg para cada imagem, o que torna o processo muito lento, mesmo se voc\u00ea usar v\u00e1rias inst\u00e2ncias em paralelo;<\/li>\n<li>As legendas n\u00e3o aparecem nas capturas por padr\u00e3o; voc\u00ea pode usar um filtro para isso, mas nem sempre \u00e9 f\u00e1cil j\u00e1 que \u00e9 complicado configurar as fontes para funcionar com esse filtro;<\/li>\n<li>O ffmpeg n\u00e3o suporta <a href=\"https:\/\/qgustavor.keybase.pub\/padoru%20(10%20hours).mkv\">certos MKVs<\/a> (que s\u00e3o raros&#8230; exceto se voc\u00ea estiver trabalhando com animes);<\/li>\n<li>As capturas ficar\u00e3o erradas para v\u00eddeos em que o aspect ratio mostrado (DAR) \u00e9 diferente do codificado (SAR);<\/li>\n<li>Alguns v\u00eddeos podem ter problemas de compatibilidade (use \u201c-x264_build 150\u201d para esses casos).<\/li>\n<\/ul>\n<p>Um m\u00e9todo alternativo que eu achei bem mais interessante \u00e9 usar o MPV para isso. Ele \u00e9 mais complexo e consiste dos seguintes passos:<\/p>\n<ol>\n<li>Abra o v\u00eddeo no MPV usando \u201c&#8211;vo=null\u201d para n\u00e3o abrir uma janela, \u201c&#8211;audio=no\u201d para n\u00e3o processar o \u00e1udio, \u201c&#8211;pause\u201d para pausar o v\u00eddeo (bem na lata, n\u00e9?), e o argumento mais importante, \u201c&#8211;input-ipc-server=\/tmp\/node-mpv.sock\u201d;<\/li>\n<li>Conecte ao MPV usando o IPC acima e aguarde pelo evento \u201cplayback-restart\u201d;<\/li>\n<li>Para cada imagem que voc\u00ea precisar tirar use o comando \u201cseek [tempo] absolute+exact\u201d, espere pelo evento \u201cplayback-restart\u201d e ent\u00e3o use o comando \u201cscreenshot-to-file [arquivo]\u201d;<\/li>\n<li>Por padr\u00e3o as legendas aparecem nas capturas (o que \u00e9 \u00f3timo!). Se quiser desativar isso s\u00f3 adicionar \u201cvideo\u201d depois do nome do arquivo nesse \u00faltimo comando.<\/li>\n<\/ol>\n<p>Assim como com o ffmpeg \u00e9 poss\u00edvel usar v\u00e1rias inst\u00e2ncias em paralelo (geralmente uso uma para cada v\u00eddeo) e, apesar de toda a dificuldade envolvendo a comunica\u00e7\u00e3o via IPC, os resultados s\u00e3o surpreendentes: todos os problemas que listei acima s\u00e3o resolvidos e claro, \u00e9 BEM mais r\u00e1pido.<\/p>\n<p><em>S\u00f3 n\u00e3o me perguntem por que tenho tantas capturas no meu computador&#8230;<\/em><\/p>\n","protected":false},"excerpt":{"rendered":"<p>Vamos supor que, por algum motivo, voc\u00ea precisa tirar milhares de capturas de v\u00eddeos em tempos espec\u00edficos, como voc\u00ea faria isso? Pesquisar no StackOverflow e pegar a primeira resposta que sair parece tentador, mas podemos fazer melhor! A maioria das respostas ir\u00e1 sugerir para usar o ffmpeg. Na maioria dos casos ele \u00e9 realmente a [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"closed","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[9],"tags":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v22.5 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\r\n<title>Capturas em massa - o canto do qgustavor<\/title>\r\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\r\n<link rel=\"canonical\" href=\"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/\" \/>\r\n<meta property=\"og:locale\" content=\"pt_BR\" \/>\r\n<meta property=\"og:type\" content=\"article\" \/>\r\n<meta property=\"og:title\" content=\"Capturas em massa - o canto do qgustavor\" \/>\r\n<meta property=\"og:description\" content=\"Vamos supor que, por algum motivo, voc\u00ea precisa tirar milhares de capturas de v\u00eddeos em tempos espec\u00edficos, como voc\u00ea faria isso? Pesquisar no StackOverflow e pegar a primeira resposta que sair parece tentador, mas podemos fazer melhor! A maioria das respostas ir\u00e1 sugerir para usar o ffmpeg. Na maioria dos casos ele \u00e9 realmente a [&hellip;]\" \/>\r\n<meta property=\"og:url\" content=\"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/\" \/>\r\n<meta property=\"og:site_name\" content=\"o canto do qgustavor\" \/>\r\n<meta property=\"article:published_time\" content=\"2020-08-19T03:06:14+00:00\" \/>\r\n<meta property=\"article:modified_time\" content=\"2024-04-27T21:34:12+00:00\" \/>\r\n<meta name=\"author\" content=\"qgustavor\" \/>\r\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\r\n<meta name=\"twitter:creator\" content=\"@qgustavor\" \/>\r\n<meta name=\"twitter:site\" content=\"@qgustavor\" \/>\r\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"Article\",\"@id\":\"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/#article\",\"isPartOf\":{\"@id\":\"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/\"},\"author\":{\"name\":\"qgustavor\",\"@id\":\"https:\/\/qgustavor.duckdns.org\/blog\/#\/schema\/person\/5005d30bb095ab19661abe12ea303b52\"},\"headline\":\"Capturas em massa\",\"datePublished\":\"2020-08-19T03:06:14+00:00\",\"dateModified\":\"2024-04-27T21:34:12+00:00\",\"mainEntityOfPage\":{\"@id\":\"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/\"},\"wordCount\":410,\"publisher\":{\"@id\":\"https:\/\/qgustavor.duckdns.org\/blog\/#\/schema\/person\/5005d30bb095ab19661abe12ea303b52\"},\"articleSection\":[\"Programa\u00e7\u00e3o\"],\"inLanguage\":\"pt-BR\"},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/\",\"url\":\"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/\",\"name\":\"Capturas em massa - o canto do qgustavor\",\"isPartOf\":{\"@id\":\"https:\/\/qgustavor.duckdns.org\/blog\/#website\"},\"datePublished\":\"2020-08-19T03:06:14+00:00\",\"dateModified\":\"2024-04-27T21:34:12+00:00\",\"breadcrumb\":{\"@id\":\"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/#breadcrumb\"},\"inLanguage\":\"pt-BR\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"In\u00edcio\",\"item\":\"https:\/\/qgustavor.duckdns.org\/blog\/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Capturas em massa\"}]},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/qgustavor.duckdns.org\/blog\/#website\",\"url\":\"https:\/\/qgustavor.duckdns.org\/blog\/\",\"name\":\"o canto do qgustavor\",\"description\":\"\",\"publisher\":{\"@id\":\"https:\/\/qgustavor.duckdns.org\/blog\/#\/schema\/person\/5005d30bb095ab19661abe12ea303b52\"},\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https:\/\/qgustavor.duckdns.org\/blog\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"pt-BR\"},{\"@type\":[\"Person\",\"Organization\"],\"@id\":\"https:\/\/qgustavor.duckdns.org\/blog\/#\/schema\/person\/5005d30bb095ab19661abe12ea303b52\",\"name\":\"qgustavor\",\"image\":{\"@type\":\"ImageObject\",\"inLanguage\":\"pt-BR\",\"@id\":\"https:\/\/qgustavor.duckdns.org\/blog\/#\/schema\/person\/image\/\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/4039a864f60bdb71f6b8ad64f0b94f87?size=256\",\"contentUrl\":\"https:\/\/secure.gravatar.com\/avatar\/4039a864f60bdb71f6b8ad64f0b94f87?size=256\",\"width\":256,\"height\":256,\"caption\":\"qgustavor\"},\"logo\":{\"@id\":\"https:\/\/qgustavor.duckdns.org\/blog\/#\/schema\/person\/image\/\"},\"sameAs\":[\"https:\/\/qgustavor.tk\",\"https:\/\/x.com\/qgustavor\"]}]}<\/script>\r\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"Capturas em massa - o canto do qgustavor","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/","og_locale":"pt_BR","og_type":"article","og_title":"Capturas em massa - o canto do qgustavor","og_description":"Vamos supor que, por algum motivo, voc\u00ea precisa tirar milhares de capturas de v\u00eddeos em tempos espec\u00edficos, como voc\u00ea faria isso? Pesquisar no StackOverflow e pegar a primeira resposta que sair parece tentador, mas podemos fazer melhor! A maioria das respostas ir\u00e1 sugerir para usar o ffmpeg. Na maioria dos casos ele \u00e9 realmente a [&hellip;]","og_url":"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/","og_site_name":"o canto do qgustavor","article_published_time":"2020-08-19T03:06:14+00:00","article_modified_time":"2024-04-27T21:34:12+00:00","author":"qgustavor","twitter_card":"summary_large_image","twitter_creator":"@qgustavor","twitter_site":"@qgustavor","schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"Article","@id":"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/#article","isPartOf":{"@id":"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/"},"author":{"name":"qgustavor","@id":"https:\/\/qgustavor.duckdns.org\/blog\/#\/schema\/person\/5005d30bb095ab19661abe12ea303b52"},"headline":"Capturas em massa","datePublished":"2020-08-19T03:06:14+00:00","dateModified":"2024-04-27T21:34:12+00:00","mainEntityOfPage":{"@id":"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/"},"wordCount":410,"publisher":{"@id":"https:\/\/qgustavor.duckdns.org\/blog\/#\/schema\/person\/5005d30bb095ab19661abe12ea303b52"},"articleSection":["Programa\u00e7\u00e3o"],"inLanguage":"pt-BR"},{"@type":"WebPage","@id":"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/","url":"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/","name":"Capturas em massa - o canto do qgustavor","isPartOf":{"@id":"https:\/\/qgustavor.duckdns.org\/blog\/#website"},"datePublished":"2020-08-19T03:06:14+00:00","dateModified":"2024-04-27T21:34:12+00:00","breadcrumb":{"@id":"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/#breadcrumb"},"inLanguage":"pt-BR","potentialAction":[{"@type":"ReadAction","target":["https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/"]}]},{"@type":"BreadcrumbList","@id":"https:\/\/qgustavor.duckdns.org\/blog\/capturas-em-massa\/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"In\u00edcio","item":"https:\/\/qgustavor.duckdns.org\/blog\/"},{"@type":"ListItem","position":2,"name":"Capturas em massa"}]},{"@type":"WebSite","@id":"https:\/\/qgustavor.duckdns.org\/blog\/#website","url":"https:\/\/qgustavor.duckdns.org\/blog\/","name":"o canto do qgustavor","description":"","publisher":{"@id":"https:\/\/qgustavor.duckdns.org\/blog\/#\/schema\/person\/5005d30bb095ab19661abe12ea303b52"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https:\/\/qgustavor.duckdns.org\/blog\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"pt-BR"},{"@type":["Person","Organization"],"@id":"https:\/\/qgustavor.duckdns.org\/blog\/#\/schema\/person\/5005d30bb095ab19661abe12ea303b52","name":"qgustavor","image":{"@type":"ImageObject","inLanguage":"pt-BR","@id":"https:\/\/qgustavor.duckdns.org\/blog\/#\/schema\/person\/image\/","url":"https:\/\/secure.gravatar.com\/avatar\/4039a864f60bdb71f6b8ad64f0b94f87?size=256","contentUrl":"https:\/\/secure.gravatar.com\/avatar\/4039a864f60bdb71f6b8ad64f0b94f87?size=256","width":256,"height":256,"caption":"qgustavor"},"logo":{"@id":"https:\/\/qgustavor.duckdns.org\/blog\/#\/schema\/person\/image\/"},"sameAs":["https:\/\/qgustavor.tk","https:\/\/x.com\/qgustavor"]}]}},"_links":{"self":[{"href":"https:\/\/qgustavor.duckdns.org\/blog\/wp-json\/wp\/v2\/posts\/109"}],"collection":[{"href":"https:\/\/qgustavor.duckdns.org\/blog\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/qgustavor.duckdns.org\/blog\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/qgustavor.duckdns.org\/blog\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/qgustavor.duckdns.org\/blog\/wp-json\/wp\/v2\/comments?post=109"}],"version-history":[{"count":1,"href":"https:\/\/qgustavor.duckdns.org\/blog\/wp-json\/wp\/v2\/posts\/109\/revisions"}],"predecessor-version":[{"id":1197,"href":"https:\/\/qgustavor.duckdns.org\/blog\/wp-json\/wp\/v2\/posts\/109\/revisions\/1197"}],"wp:attachment":[{"href":"https:\/\/qgustavor.duckdns.org\/blog\/wp-json\/wp\/v2\/media?parent=109"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/qgustavor.duckdns.org\/blog\/wp-json\/wp\/v2\/categories?post=109"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/qgustavor.duckdns.org\/blog\/wp-json\/wp\/v2\/tags?post=109"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}